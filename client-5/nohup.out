2023-10-28 11:05:08.352035: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
--------------------
START TIME - 1698509118.7866108
SHAPE - 7996
SHAPE - 0
Model: "model_lstm"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 4)]               0         
                                                                 
 lambda (Lambda)             (None, 1, 4)              0         
                                                                 
 lstm (LSTM)                 (None, 10)                600       
                                                                 
 dense (Dense)               (None, 1)                 11        
                                                                 
=================================================================
Total params: 611
Trainable params: 611
Non-trainable params: 0
_________________________________________________________________
INFO flwr 2023-10-28 11:05:19,148 | grpc.py:49 | Opened insecure gRPC connection (no certificates were passed)
DEBUG flwr 2023-10-28 11:05:19,150 | connection.py:42 | ChannelConnectivity.IDLE
DEBUG flwr 2023-10-28 11:05:19,152 | connection.py:42 | ChannelConnectivity.CONNECTING
DEBUG flwr 2023-10-28 11:05:19,171 | connection.py:42 | ChannelConnectivity.READY
Rounds - 1
Epoch 1/10
  1/250 [..............................] - ETA: 7:00 - loss: 1638.0619 - mape: 100.0000 22/250 [=>............................] - ETA: 0s - loss: 1451.1985 - mape: 99.7698    41/250 [===>..........................] - ETA: 0s - loss: 1457.3324 - mape: 99.5312 61/250 [======>.......................] - ETA: 0s - loss: 1476.9918 - mape: 99.3070 81/250 [========>.....................] - ETA: 0s - loss: 1478.7115 - mape: 99.0691103/250 [===========>..................] - ETA: 0s - loss: 1473.4230 - mape: 98.7980126/250 [==============>...............] - ETA: 0s - loss: 1474.4055 - mape: 98.5518151/250 [=================>............] - ETA: 0s - loss: 1472.8807 - mape: 98.2527175/250 [====================>.........] - ETA: 0s - loss: 1475.1351 - mape: 97.9812199/250 [======================>.......] - ETA: 0s - loss: 1504.7422 - mape: 99.4388222/250 [=========================>....] - ETA: 0s - loss: 1503.3723 - mape: 99.0391246/250 [============================>.] - ETA: 0s - loss: 1497.2571 - mape: 98.6384250/250 [==============================] - 2s 2ms/step - loss: 1497.2565 - mape: 98.5705
Epoch 2/10
  1/250 [..............................] - ETA: 0s - loss: 1673.3186 - mape: 95.2215 21/250 [=>............................] - ETA: 0s - loss: 1477.8827 - mape: 94.3034 42/250 [====>.........................] - ETA: 0s - loss: 1451.2845 - mape: 94.0911 65/250 [======>.......................] - ETA: 0s - loss: 1439.6465 - mape: 93.7142 88/250 [=========>....................] - ETA: 0s - loss: 1441.8004 - mape: 93.4549110/250 [============>.................] - ETA: 0s - loss: 1437.4507 - mape: 93.1786131/250 [==============>...............] - ETA: 0s - loss: 1428.4375 - mape: 92.8508151/250 [=================>............] - ETA: 0s - loss: 1424.7671 - mape: 92.5916169/250 [===================>..........] - ETA: 0s - loss: 1425.1108 - mape: 92.3825188/250 [=====================>........] - ETA: 0s - loss: 1422.8906 - mape: 92.0800212/250 [========================>.....] - ETA: 0s - loss: 1419.1771 - mape: 91.7689237/250 [===========================>..] - ETA: 0s - loss: 1424.1388 - mape: 91.5782250/250 [==============================] - 1s 2ms/step - loss: 1424.0499 - mape: 91.4526
Epoch 3/10
  1/250 [..............................] - ETA: 0s - loss: 1490.9236 - mape: 88.7754 25/250 [==>...........................] - ETA: 0s - loss: 1356.8594 - mape: 87.7770 48/250 [====>.........................] - ETA: 0s - loss: 1377.3558 - mape: 87.6202 74/250 [=======>......................] - ETA: 0s - loss: 1381.7736 - mape: 87.4594 99/250 [==========>...................] - ETA: 0s - loss: 1377.3922 - mape: 87.1445121/250 [=============>................] - ETA: 0s - loss: 1385.5764 - mape: 87.0675142/250 [================>.............] - ETA: 0s - loss: 1385.5264 - mape: 86.8240164/250 [==================>...........] - ETA: 0s - loss: 1391.7007 - mape: 86.7955188/250 [=====================>........] - ETA: 0s - loss: 1381.4003 - mape: 86.3527210/250 [========================>.....] - ETA: 0s - loss: 1378.5841 - mape: 86.2236232/250 [==========================>...] - ETA: 0s - loss: 1372.6714 - mape: 85.9947250/250 [==============================] - 1s 2ms/step - loss: 1374.5117 - mape: 85.9050
Epoch 4/10
  1/250 [..............................] - ETA: 0s - loss: 1472.5271 - mape: 84.7430 23/250 [=>............................] - ETA: 0s - loss: 1369.7029 - mape: 84.3858 46/250 [====>.........................] - ETA: 0s - loss: 1365.9764 - mape: 83.9485 71/250 [=======>......................] - ETA: 0s - loss: 1351.3309 - mape: 83.6804 93/250 [==========>...................] - ETA: 0s - loss: 1342.4156 - mape: 83.3767117/250 [=============>................] - ETA: 0s - loss: 1339.8356 - mape: 83.2900141/250 [===============>..............] - ETA: 0s - loss: 1337.5885 - mape: 83.1472168/250 [===================>..........] - ETA: 0s - loss: 1330.9377 - mape: 82.9178191/250 [=====================>........] - ETA: 0s - loss: 1330.4756 - mape: 82.9146215/250 [========================>.....] - ETA: 0s - loss: 1328.3313 - mape: 82.7822245/250 [============================>.] - ETA: 0s - loss: 1330.3219 - mape: 82.6790250/250 [==============================] - 1s 2ms/step - loss: 1329.9371 - mape: 82.6397
Epoch 5/10
  1/250 [..............................] - ETA: 0s - loss: 1584.6130 - mape: 79.6748 33/250 [==>...........................] - ETA: 0s - loss: 1314.9769 - mape: 81.7158 67/250 [=======>......................] - ETA: 0s - loss: 1310.7429 - mape: 81.3798100/250 [===========>..................] - ETA: 0s - loss: 1307.4562 - mape: 81.1376133/250 [==============>...............] - ETA: 0s - loss: 1302.0117 - mape: 80.9102168/250 [===================>..........] - ETA: 0s - loss: 1303.5004 - mape: 80.8070201/250 [=======================>......] - ETA: 0s - loss: 1295.5490 - mape: 80.5312233/250 [==========================>...] - ETA: 0s - loss: 1290.5803 - mape: 80.3821250/250 [==============================] - 0s 2ms/step - loss: 1286.6310 - mape: 80.2183
Epoch 6/10
  1/250 [..............................] - ETA: 0s - loss: 1233.1978 - mape: 76.0981 34/250 [===>..........................] - ETA: 0s - loss: 1251.9489 - mape: 78.6725 69/250 [=======>......................] - ETA: 0s - loss: 1259.1992 - mape: 78.5765104/250 [===========>..................] - ETA: 0s - loss: 1260.8214 - mape: 78.6793138/250 [===============>..............] - ETA: 0s - loss: 1260.8823 - mape: 78.6517170/250 [===================>..........] - ETA: 0s - loss: 1253.5089 - mape: 78.4068200/250 [=======================>......] - ETA: 0s - loss: 1249.7112 - mape: 78.3064233/250 [==========================>...] - ETA: 0s - loss: 1248.7731 - mape: 78.0595250/250 [==============================] - 0s 2ms/step - loss: 1243.3923 - mape: 77.9109
Epoch 7/10
  1/250 [..............................] - ETA: 0s - loss: 1201.9822 - mape: 73.8480 35/250 [===>..........................] - ETA: 0s - loss: 1215.4532 - mape: 76.3469 68/250 [=======>......................] - ETA: 0s - loss: 1223.3776 - mape: 76.3192102/250 [===========>..................] - ETA: 0s - loss: 1218.6871 - mape: 76.2551137/250 [===============>..............] - ETA: 0s - loss: 1213.0211 - mape: 76.2269172/250 [===================>..........] - ETA: 0s - loss: 1203.5078 - mape: 76.0874206/250 [=======================>......] - ETA: 0s - loss: 1202.6453 - mape: 76.0594238/250 [===========================>..] - ETA: 0s - loss: 1199.0895 - mape: 75.7550250/250 [==============================] - 0s 2ms/step - loss: 1200.1776 - mape: 75.7486
Epoch 8/10
  1/250 [..............................] - ETA: 0s - loss: 1004.5387 - mape: 77.2444 31/250 [==>...........................] - ETA: 0s - loss: 1174.7861 - mape: 74.3291 64/250 [======>.......................] - ETA: 0s - loss: 1183.9425 - mape: 74.8325 98/250 [==========>...................] - ETA: 0s - loss: 1184.4921 - mape: 74.7382133/250 [==============>...............] - ETA: 0s - loss: 1174.4590 - mape: 74.2825167/250 [===================>..........] - ETA: 0s - loss: 1165.8960 - mape: 74.0340200/250 [=======================>......] - ETA: 0s - loss: 1158.4938 - mape: 73.7367235/250 [===========================>..] - ETA: 0s - loss: 1157.5895 - mape: 73.6175250/250 [==============================] - 0s 2ms/step - loss: 1157.1689 - mape: 73.6713
Epoch 9/10
  1/250 [..............................] - ETA: 0s - loss: 1188.3969 - mape: 66.8518 35/250 [===>..........................] - ETA: 0s - loss: 1150.8229 - mape: 71.3933 71/250 [=======>......................] - ETA: 0s - loss: 1137.9816 - mape: 71.7496107/250 [===========>..................] - ETA: 0s - loss: 1138.7130 - mape: 71.9333143/250 [================>.............] - ETA: 0s - loss: 1133.1433 - mape: 71.9804178/250 [====================>.........] - ETA: 0s - loss: 1124.2336 - mape: 71.9008209/250 [========================>.....] - ETA: 0s - loss: 1123.1271 - mape: 71.9358241/250 [===========================>..] - ETA: 0s - loss: 1120.4833 - mape: 71.8839250/250 [==============================] - 0s 2ms/step - loss: 1116.4906 - mape: 72.0623
Epoch 10/10
  1/250 [..............................] - ETA: 0s - loss: 1015.2146 - mape: 82.6754 31/250 [==>...........................] - ETA: 0s - loss: 1112.1531 - mape: 72.6307 61/250 [======>.......................] - ETA: 0s - loss: 1106.0704 - mape: 72.4543 92/250 [==========>...................] - ETA: 0s - loss: 1097.1425 - mape: 72.1359122/250 [=============>................] - ETA: 0s - loss: 1086.9031 - mape: 71.3931153/250 [=================>............] - ETA: 0s - loss: 1090.7463 - mape: 71.5831184/250 [=====================>........] - ETA: 0s - loss: 1091.3782 - mape: 71.7710215/250 [========================>.....] - ETA: 0s - loss: 1089.8772 - mape: 71.6646244/250 [============================>.] - ETA: 0s - loss: 1081.6067 - mape: 71.2036250/250 [==============================] - 0s 2ms/step - loss: 1080.3766 - mape: 71.0578
/Users/beast/opt/anaconda3/lib/python3.9/site-packages/keras/utils/generic_utils.py:239: RuntimeWarning: divide by zero encountered in log10
  numdigits = int(np.log10(self.target)) + 1
DEBUG flwr 2023-10-28 11:05:26,039 | connection.py:139 | gRPC channel closed
Traceback (most recent call last):
  File "/Volumes/beast/Personal/GitHub/Barathwaja/federated-learning/client-5/fl.lstm.py", line 178, in <module>
    fl.client.start_numpy_client(server_address=SERVER_ADDR, 
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/app.py", line 288, in start_numpy_client
    start_client(
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/app.py", line 205, in start_client
    task_res, sleep_duration, keep_going = handle(client, task_ins)
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 82, in handle
    client_msg, sleep_duration, keep_going = handle_legacy_message(client, server_msg)
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 121, in handle_legacy_message
    return _evaluate(client, server_msg.evaluate_ins), 0, True
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 193, in _evaluate
    evaluate_res = maybe_call_evaluate(
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Volumes/beast/Personal/GitHub/Barathwaja/federated-learning/client-5/fl.lstm.py", line 169, in evaluate
    eval_loss, eval_mape = self.model.evaluate(X_test, y_test)
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/Users/beast/opt/anaconda3/lib/python3.9/site-packages/keras/utils/generic_utils.py", line 239, in update
    numdigits = int(np.log10(self.target)) + 1
OverflowError: cannot convert float infinity to integer
